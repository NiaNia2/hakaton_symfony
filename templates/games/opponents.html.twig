{% extends 'base.html.twig' %}

{% block title %}Adversaires{% endblock %}

{% block body %}
    <section id="island">
        <div class="island">
            <div class="team-container">
                <div class="team-owner">
                    <h2>Adversaires disponibles</h2>
                </div>

                {% if not myTeam %}
                    <div class="alert alert-warning">Vous n’avez pas encore d’équipe. Créez vos 3 unités avant d’attaquer.</div>
                {% else %}
                    {% if not myTeam.unitOne or not myTeam.unitTwo or not myTeam.unitThree %}
                        <div class="alert alert-warning">Votre équipe n’est pas complète (3 unités requises) pour lancer un combat.</div>
                    {% endif %}
                {% endif %}

                {% if opponents is empty %}
                    <p>Aucun adversaire avec une équipe complète pour le moment.</p>
                {% else %}
                    {% for team in opponents %}
                        <div class="team-owner">
                            <h2>Équipe de {{ team.user ? team.user.pseudo ?? team.user.email ?? ('User #' ~ team.user.id) : 'Anonyme' }}</h2>
                        </div>
                        <div class="team-card">
                            <div id="unitOne" class="not-islander">
                                <div id="unitOnePreview">
                                    {% if team and team.unitOne %}
                                        {% include 'games/units/_unit_card.html.twig' with { unit: team.unitOne } %}
                                    {% endif %}
                                </div>
                            </div>
                            <div id="unitTwo" class="not-islander">
                                <div id="unitTwoPreview">
                                    {% if team and team.unitTwo %}
                                        {% include 'games/units/_unit_card.html.twig' with { unit: team.unitTwo } %}
                                    {% endif %}
                                </div>
                            </div>
                            <div id="unitThree" class="not-islander">
                                <div id="unitThreePreview">
                                    {% if team and team.unitThree %}
                                        {% include 'games/units/_unit_card.html.twig' with { unit: team.unitThree } %}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="mt-3" style="text-align:center;">
                            {% if myTeam and myTeam.id and team.id and myTeam.unitOne and myTeam.unitTwo and myTeam.unitThree %}
                                <a class="btn-alt"
                                   href="{{ path('battle_view', { teamA: myTeam.id, teamB: team.id }) }}">
                                    Combattre
                                </a>
                            {% else %}
                                <button class="btn btn-secondary" disabled>Équipe incomplète</button>
                            {% endif %}
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </section>
{% endblock %}

