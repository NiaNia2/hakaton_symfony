{% extends 'base.html.twig' %}

{% block title %}
    {% if app.user.id == team.user.id%}
        Mon île
    {% else %}
        Île de {{ user.pseudo }}
    {% endif %}
{% endblock %}

{% block body %}
    <section id="island">
        <div class="island">
            <div class="island-title">
                {% if app.user.id == team.user.id%}
                    <h2>Mon île</h2>
                {% else %}
                    <h2>Île de {{ user.pseudo }}</h2>
                {% endif %}
            </div>
            <div class="team-container">
                <div class="team-owner">
                    {% if app.user.id == team.user.id%}
                        <h2>Mon équipe</h2>
                    {% else %}
                        <h2>Équipe de {{ user.pseudo }}</h2>
                    {% endif %}
                </div>
                <div class="team-card">
                    <form method="post">

                        {# --- Unité 1 --- #}
                        <div>
                            <label for="unitOneType">Unité 1 - Type</label>
                            <select id="unitOneType" name="unitOneType"
                                    hx-post="{{ path('units_colors_by_type') }}"
                                    hx-trigger="change"
                                    hx-target="#unitOneColor"
                                    hx-swap="innerHTML"
                                    hx-include="[name='unitOneType']">
                                <option value="" disabled {{ (unitOneType|default(null)) is null ? 'selected' : '' }}>— choisir un type —</option>
                                {% for row in types %}
                                    <option value="{{ row.type }}" {{ row.type == (unitOneType|default(null)) ? 'selected' : '' }}>
                                        {{ row.type }}
                                    </option>
                                {% endfor %}
                            </select>

                            <label for="unitOneColor">Couleur</label>
                            <select id="unitOneColor" name="unitOneColor"
                                    hx-get="{{ path('units_colors_by_type', { type: (unitOneType|default(null)) ?? types|first.type }) }}"
                                    hx-trigger="load"
                                    hx-swap="innerHTML">
                                {% if (unitOneColor|default(null)) is null %}
                                    <option value="" disabled selected>— choisir une couleur —</option>
                                {% endif %}
                            </select>
                        </div>

                        {# --- Unité 2 --- #}
                        <div>
                            <label for="unitTwoType">Unité 2 - Type</label>
                            <select id="unitTwoType" name="unitTwoType"
                                    hx-post="{{ path('units_colors_by_type') }}"
                                    hx-trigger="change"
                                    hx-target="#unitTwoColor"
                                    hx-swap="innerHTML"
                                    hx-include="[name='unitTwoType']">
                                <option value="" disabled {{ (unitTwoType|default(null)) is null ? 'selected' : '' }}>— choisir un type —</option>
                                {% for row in types %}
                                    <option value="{{ row.type }}" {{ row.type == (unitTwoType|default(null)) ? 'selected' : '' }}>
                                        {{ row.type }}
                                    </option>
                                {% endfor %}
                            </select>

                            <label for="unitTwoColor">Couleur</label>
                            <select id="unitTwoColor" name="unitTwoColor"
                                    hx-get="{{ path('units_colors_by_type', { type: (unitTwoType|default(null)) ?? types|first.type }) }}"
                                    hx-trigger="load"
                                    hx-swap="innerHTML">
                                {% if (unitTwoColor|default(null)) is null %}
                                    <option value="" disabled selected>— choisir une couleur —</option>
                                {% endif %}
                            </select>
                        </div>

                        {# --- Unité 3 --- #}
                        <div>
                            <label for="unitThreeType">Unité 3 - Type</label>
                            <select id="unitThreeType" name="unitThreeType"
                                    hx-post="{{ path('units_colors_by_type') }}"
                                    hx-trigger="change"
                                    hx-target="#unitThreeColor"
                                    hx-swap="innerHTML"
                                    hx-include="[name='unitThreeType']">
                                <option value="" disabled {{ (unitThreeType|default(null)) is null ? 'selected' : '' }}>— choisir un type —</option>
                                {% for row in types %}
                                    <option value="{{ row.type }}" {{ row.type == (unitThreeType|default(null)) ? 'selected' : '' }}>
                                        {{ row.type }}
                                    </option>
                                {% endfor %}
                            </select>

                            <label for="unitThreeColor">Couleur</label>
                            <select id="unitThreeColor" name="unitThreeColor"
                                    hx-get="{{ path('units_colors_by_type', { type: (unitThreeType|default(null)) ?? types|first.type }) }}"
                                    hx-trigger="load"
                                    hx-swap="innerHTML">
                                {% if (unitThreeColor|default(null)) is null %}
                                    <option value="" disabled selected>— choisir une couleur —</option>
                                {% endif %}
                            </select>
                        </div>

                        <button type="submit">Sauvegarder</button>
                    </form>
                </div>
            </div>
        </div>
    </section>
{% endblock %}
